@model YourProject.Models.Sach

@{
    ViewData["Title"] = "Chi tiết Sách";
}

<h1>Chi tiết Sách</h1>
<hr />

<div class="row">
    <div class="col-md-4">
        <img src="https://freenice.net/wp-content/uploads/2021/10/Background-book-sach-da-dang-doc-dao-chat-luong-cao.jpg" class="img-fluid" alt="Bìa sách">
    </div>

    <div class="col-md-8">
        <h3>@Model.TenSach</h3>
        <dl class="row">
            <dt class = "col-sm-3">Tác giả</dt>
            <dd class = "col-sm-9">@Model.TacGia?.TenTacGia</dd>

            <dt class = "col-sm-3">Thể loại</dt>
            <dd class = "col-sm-9">@Model.TheLoai?.TenTheLoai</dd>

            <dt class = "col-sm-3">Năm xuất bản</dt>
            <dd class = "col-sm-9">@Model.NamXuatBan</dd>

            <dt class = "col-sm-3">Số lượng còn lại</dt>
            <dd class = "col-sm-9">@Model.SoLuong</dd>

            <dt class = "col-sm-3">Mô tả</dt>
            <dd class = "col-sm-9">@Model.MoTa</dd>
        </dl>
    </div>
</div>
<div class="mt-3">
    <a asp-action="Edit" asp-route-id="@Model?.MaSach" class="btn btn-primary edit-button">Sửa</a> 
    <a asp-action="Index" class="btn btn-secondary">Quay lại danh sách</a>
</div>

<div class="modal fade" id="editModal" tabindex="-1" aria-hidden="true">
  <div class="modal-dialog modal-lg"><div class="modal-content">
      <div class="modal-header"><h5 class="modal-title">Sửa thông tin Sách</h5><button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button></div>
      <div class="modal-body"></div>
  </div></div>
</div>

@section Scripts {
    <script>
        $(function () {
            // Mở modal
            $('.edit-button').on('click', function (e) {
                e.preventDefault();
                var url = $(this).attr('href');
                $('#editModal .modal-body').load(url, function () {
                    $('#editModal').modal('show');
                });
            });

            // Xử lý submit form
            $('#editModal').delegate('#editForm', 'submit', function (e) {
                e.preventDefault();
                var form = $(this);
                $.ajax({
                    url: form.attr('action'),
                    method: 'POST',
                    data: form.serialize(),
                    success: function (response) {
                        if (response.success) {
                            $('#editModal').modal('hide');
                            alert('Cập nhật thành công!');
                            location.reload();
                        } else {
                            $('#editModal .modal-body').html(response);
                        }
                    },
                    error: function () {
                        alert('Đã xảy ra lỗi, vui lòng thử lại.');
                    }
                });
            });
        });
    </script>
}